# OAS
SQL queries to the training database Orel AutoService
В файле содержатся задания по 8 темам:

## Простая выборка (по одной таблице)

1.	Выдать список механиков (все столбцы таблицы mechanic). <br> Ответ: 24 строки, 5 столбцов. 

2.	Выдать государственные номерные знаки, серии, номера и даты выдачи свидетельств о регистрации транспортных средств (таблица vehicle). <br> Ответ: 161 строка, 4 столбца. 

3.	Сформировать список автомобилей, прошедших обслуживание (таблица maintenance), путем указания 
их государственных номерных знаков (без дублика-тов). <br> Ответ: 159 строк (без дубликатов), 1 столбец.

4.	Выдать список государственных номерных знаков, серии, номера и даты выдачи свидетельств о 
регистрации транспортных средств в виде таблицы из двух колонок – "Государственный номерной знак",
"Свидетельство о регистрации транспортного средства". <br> Ответ: 161 строка, 2 столбца.

5.	Сформировать список автомобильных заводов с указанием наименования, адреса фактического
размещения и контактного телефона. Перечень должен быть отсортирован по наименованию, по алфавиту.

<br> Ответ: 22 строки, 3 столбца.

6.	Составить список групп транспортных средств (таблица transpgroup) в формате
<идентификатор группы>: <наименование группы> - <описание> (колонки id_tg, name и note, соответственно). Результирующий столбец должен быть именован, как "Группы транспортных средств". <br> Ответ: 14 строк, 1 столбец. 

7.	Составить список автомобилей с указанием их государственного номерного знака, стоимости и уплаченной суммы налога на добавленную стоимость, которая рас-считывается по ставке 20%.

<br> Ответ: 161 строка, 3 столбца. Если посчитать итоговую сумму налогов, то долж-но получиться 73 750 058 руб. 00 коп. Проверка:

select sum("cost" * 0.2) from vehicle v;

8.	Рассчитать суммарную стоимость зарегистрированных автомобилей. Результат представить в денежном формате (длина мантиссы равна 2). <br> Ответ: 368 750 290.00.

9.	Выдать фамилии, инициалы и дату рождения механиков (получить в результирующей выборке один столбец со значениями вида "Светлов В.К., дата рождения 01.06.1967"). Для форматирования дат рождения использовать маску dd.mm.yyyy. Дать столбцу альтернативное имя "Лучшие механики предприятия". Ограничить список первыми пятью механиками, сортировку не производить. <br> Ответ: 5 строк, 1 столбец.

Пример записи в ответе: Савостьянов А.В., дата рождения 23.03.1970

10.	 Выдать фамилии, инициалы, даты рождения в формате 'dd.mm.yyyy' и возраст (в полных годах) механиков (использовать встроенную функцию age для работы с интервалами дат; выражение вида trunc((current_date-born)/365) некорректно, так как оно не учитывает високосные года).
<br> Ответ: 24 строки, 3 столбца. Если посчитать, сколько лет прожили все механики, то должно получиться 1088 года.

11.	 Рассчитать отношение стоимости каждого автомобиля к его пробегу в километрах с точностью до копейки. Результат представить в виде: "<государственный номер-ной знак>-<значение отношения стоимости к пробегу> руб/км". <br> Ответ: 161 строка, 1 столбец.

12.	 Сформировать список автомобилей (государственный номерной знак) с указанием в отдельном столбце даты, а в отдельном столбце времени прохождения обслужи-вания (таблица maintenance). <br> Ответ: 637 строк, 3 столбца.

13.	 Сформировать ведомость амортизационной стоимости автомобилей, учитывая, что за каждый полный год объект учета теряет 7% первоначальной стоимости. Для автомобилей, амортизационная стоимость которых меньше нуля, указывать отрицательную величину. Возраст автомобиля считать от даты ввода в эксплуатацию – date_use (таблица vehicle). В ведомость включить государственные номерные знаки, дату ввода в эксплуатацию и остаточную стоимость. <br> Ответ: 161 строка, 3 столбца.

14.	 Сформировать список автомобилей с указанием дня недели и порядкового дня года, в который они выпущены (столбец date_made таблицы vehicle). Результат оформить в виде одного столбца с именем "День недели и день года выпуска". <br> Ответ: 161 строка, 1 столбец.

## Отбоp по условию и сортировка (по одной таблице)

15.	 Найти российские автомобильные заводы, у которых почтовый и фактический ад-реса совпадают. Сформировать список с именами, фактическими адресами и кон-тактными телефонами предприятий. <br> Ответ: 2 строки, 3 столбца.

16.	 Составить список механиков, имеющих трудовой стаж (столбец certif_date) более 13 лет. Выдать фамилии и инициалы механиков, даты выдачи сертификатов и приема на работу, трудовой стаж (полных лет), отсортировать список по возрастанию трудового стажа. <br> Ответ: 15 строк (для запроса в 2022 году), 4 столбца.

17.	 Найти автомобили, для которых НДС, уплаченный при приобретении, превосходит 600 000 рублей (НДС рассчитывается по ставке 20% от суммы платежа). Выдать государственные номерные знаки, суммы и даты поступления уплаченного НДС. Выдачу отсортировать по уменьшению суммы уплаченного НДС.
<br> Ответ: 32 строки, 3 столбца. Расчет суммы налогов дает значение 48 026 666 руб. 00 коп. 

18.	 Сформировать список автомобилей, зарегистрированных в Орловской области. Вывести государственный номерной знак, серию, номер и дату выдачи свидетельства о регистрации транспортного средства. Отсортировать данные по региону регистрации, по убыванию. <br> Ответ: 146 строк, 4 столбца. В запросе следует учесть, что код региона Орловской области может быть любым из множества {57,  157, 757}.

19.	 Найти работы, выполненные в выходные дни (субботу и воскресенье). Выдать государственные номерные знаки автомобилей, даты проведения работ, дни недели, в которые они проводились, и технические заключения по их результатам (tech_cond_resume). <br> Ответ: 182 строки, 4 столбца. 96 работ проведено в воскресенье, остальные – в субботу.

20.	 Сформировать список работ, проведенных в выходные дни (кроме праздничных), по которым не сформировано техническое заключение специалиста. <br> Ответ: 14 строк, 4 столбца.

21.	 Найти наименования отечественных моделей автомобилей, сформированных в соответствие с советским ГОСТ классификации и кодирования (кодировка номера модели имеет четыре разряда). <br> Ответ: 21 строка, 1 столбец.

22.	 Выдать фамилии, инициалы механиков с фамилиями, начинающимися на буквы "А", "Ч", "Г" с упорядочением результирующей выборки по фамилии. <br> Ответ: 4 строки (по одному на каждую букву "А" и "Ч", двое – на букву "Г"), 1 столбец.

23.	 Найти автомобильные заводы, в названиях или почтовых адресах или фактических адресах которых встречается символ подчеркивания "_" (использовать предикат LIKE с конструкцией ESCAPE). Выдать названия юридических лиц, их почтовые и фактические адреса и телефоны. <br> Ответ: 1 строки, 4 столбца. Предприятие "Bavarischen motorwerke ainth"

24.	 Определить, когда последний раз проводилось обслуживание автомобиля с государственным номерным знаком 'c910ca57'. Результат представить в виде даты в формате "день.месяц.год" с указание тысячелетия (четырехразрядное обозначение года). <br> Ответ: 28.01.2019.

25.	 Определить автомобили, которые в 2018 году посетили предприятие для обслуживания или ремонта. <br> Ответ: 158 строк, 1 столбец.

26.	 Найти технические заключения, серия которых состоит только из цифр. Выдать серии, номера заключений и даты выполнения работ. <br> Ответ: 30 строк, 3 столбца.

27.	 Найти технические заключения о проведенных работах, которые в серии имеют буквосочетание "ТО" в любом регистре, на любой позиции, выданные на работы, проведенные в 2019 году. Выдать серии и номера технических заключений через пробел в одном столбце. <br> Ответ: 96 строк, 1 столбец.

28.	 Найти работы, выполненные в последний день месяца (учитывать високосные годы). Выдать серии и номера технических заключений, даты (без указания времени) проведения работ, содержание заключения. <br> Ответ: 19 строк, 4 столбца.

29.	 Найти автомобили, зарегистрированные за пределами Орловской области (код региона государственного номерного знака не входит во множество {57, 157, 757}). Выдать государственные номерные знаки, даты изготовления, даты начала эксплуатации, серии, номера и даты выдачи свидетельств о регистрации транспортных средств. Результат отсортировать по дате начала эксплуатации. <br> Ответ: 15 строк, 6 столбцов.

30.	 Сформировать сортированный список государственных номерных знаков зарегистрированных автомобилей с добавлением столбца с порядковым номером записи, с названием "numrow". <br> Ответ: 161 строка, 2 столбца.

## Выборка из нескольких таблиц

31.	 Сформировать список производителей автомобилей и принадлежащих им заводов, отсортированный по столбцу "Производитель" по алфавиту. Столбец с названиями заводов именовать как "Завод". <br> Ответ: 22 строки,  2 столбца.

32.	 Составить список автомобилей с указанием их государственного номерного знака (таблица vehicle), производителя (таблица brand), наименования марки (таблица marka) и модели (таблица model). Выдачу сформировать в виде двух столбцов – "Государственный номерной знак" и "Автомобиль". Во втором столбце должны быть через запятую указаны производитель, марка и модель. Учесть, что при конкатенации строк если одно из выражений возвращает NULL, то и вся строка примет значение NULL (использовать функцию COALESCE). <br> Ответ: 161 строка, 2 столбца.

33.	 Создать список контактных телефонов производителей (телефоны заводов), по которым могут обратиться владельцы автомобилей. Указать государственный номерной знак автомобиля, наименование производителя и контактный телефон завода, на котором произведен автомобиль. <br> Ответ: 161 строка, 3 столбца.

34.	 Составить список механиков, обслуживавших автомобиль с государственным номерным знаком "o009oo57". В выдачу включить дату проведения работ в формате "dd.mm.yyyy" и фамилию и инициалы механика. Результат отсортировать в хронологическом порядке. <br> Ответ: 13 строк, 2 столбца.

35.	 Найти автомобили производства Японии. Указать производителя, марку, модель, разделенные пробелами в одном столбце, и государственный номерной знак. Учесть, что ряд автомобилей в атрибуте marka имеют значение NULL. <br> Ответ: 22 строки, 2 столбца.

36.	 Сформировать список автомобилей, сменивших владельца (самосоединение таблицы vehicle со своей копией, совпадают даты изготовления, производители, марки, модели; различаются государственные номерные знаки, серии, номера и даты выдачи свидетельств о регистрации транспортных средств). В выдачу включить столбец "Дата изготовления", указать установленный ранее государственный номерной знак, серию, номер и дату (в формате "dd.mm.yyyy") выдачи свидетельства о регистрации транспортного средства в одном столбце, разделив пробелами. Такие же данные должны быть приведены по новому государственному регистрационному знаку и свидетельству о регистрации транспортного средства (всего в результирующей выборке должно быть 5 столбцов). <br> Ответ: один автомобиль (изготовлен 12 июля 2018 года).

37.	 Выдать список механиков (фамилии и инициалы), государственные номерные знаки обслуженных или отремонтированных ими автомобилей и даты выполнения работ с учетом возможности отсутствия выполненных заказов некоторыми механиками (использовать левое внешнее соединение, left outer join). <br> Ответ: 639 строк, 3 столбца. Заказы не выполняли Калатошкин М.П. и Лискунов М.В. 

38.	 Сформировать список технических заключений по ремонтам автомобилей BMW. В выдачу включить наименование производителя, наименование завода, дату проведения ремонта без указания времени, формулировку технического заключения. Список технических заключений отсортировать по дате оформления. <br> Ответ: 11 строк, 4 столбца.

39.	 Найти автомобильные предприятия, расположенные на той же улице, что и "ОАО АВТОВАЗ". Выдать наименование, почтовый и фактический адрес, контактный телефон. Использовать самосоединение. <br> Ответ: Опытный завод специальных автомобилей ОАО АВТОВАЗ.

40.	 Найти автомобили, которые обслуживал тот же механик, что и автомобиль с государственным номерным знаком "o929ao57". Выдать государственные номерные знаки обслуженных автомобилей, даты выполнения работ и в отдельном столбце время выполнения работ в 24-часовом формате без указания секунд. <br> Ответ: 40 строк, 3 столбца.

41.	 Сформировать список автомобилей, свидетельство о регистрации транспортного средства которых имеет ту же серию, что и документ автомобиля с государственным номерным знаком "c172ac57". В выдачу включить только автомобили того же производителя, что и автомобиль с государственным номерным знаком "c172ac57", указать их государственный номерной знак, наименование производителя, дату ввода в эксплуатацию (date_use). <br> Ответ: 3 строки, 3 столбца. В выдаче не должно быть строки с данными об автомобиле с государственным номерным знаком "c172ac57".

## Вложенные запросы

42.	 Найти автомобили, которые никогда не обслуживались предприятием. Выдать список государственных номерных знаков этих автомобилей. <br> Ответ: 2 строки, 1 столбец. Автомобили "c519op57"и "a333aa57".

43.	 Составить список автомобилей (государственный номерной знак и стоимость), которые стоят не более средней стоимости всех зарегистрированных автомобилей. <br> Ответ: 111 строк, 2 столбца. Сумма стоимости найденных автомобилей 83 170 150 руб. 00 коп.

44.	 Найти автомобили, которые были приобретены не новыми. К таким можно отнести экземпляры, у которых год и месяц начала эксплуатации и год и месяц даты выдачи свидетельства о регистрации транспортного средства не совпадают. <br> Ответ: 76 автомобилей, один из которых имеет государственный номерной знак "o002oo57".

45.	 Найти автомобили, изготовленные на том же заводе, что и автомобиль с государственным номерным знаком "x027kp57". Выдать их государственные номерные знаки, наименование, почтовый адрес и контактный телефон завода. <br> Ответ: автомобиль с государственным номерным знаком "c014xp57", изготовленный на заводе BMW в Австрии.

46.	 Составить список автомобильных брендов, не имеющих собственного производства на территории Российской Федерации. Указать их наименования, государственную принадлежность. <br> Ответ: 7 компаний, три из ФРГ, две из Франции и две из Японии.

47.	 Найти производителей, которые имеют заводы, как на территории Российской Федерации, так и за ее пределами. Указать наименование бренда, название и адрес размещения завода. <br> Ответ: производители "BMW" и "Mercedes-Benz". Всего 6 строк.

48.	 Определить почтовый адрес завода, изготовившего автомобиль с государственным номерным знаком "a723ak57", для направления претензии по недостатку, выявленному в ходе проведения ремонта 6 ноября 2018 года. В выдачу включить государственный номерной знак, производителя, марку и модель автомобиля в одной колонке через запятую, дату изготовления автомобиля, наименование завода-изготовителя, его почтовый адрес, дату проведения ремонта, серию и номер выданной диагностической карты в одной колонке через пробел, техническое заключение по ремонту. <br> Ответ: 1 строка, 8 столбцов.

49.	 Рассчитать количество заказов по видам работ. Выдачу сформировать в виде таблицы, где предусмотреть три столбца: "Техническое обслуживание", включив в подсчет все виды технического обслуживания: "Ремонт"; "Предпродажная подготовка". <br> Ответ: 499 ТО, 141 ремонтов, 86 предпродажных подготовок.

50.	 Найти механиков, которые выполнили 2 и более заказов в один день. Выдать их фамилии и инициалы. <br> Ответ: 8 механиков, один из которых Слепцов П.Н.

## Теоретико-множественные операции

51.	 Найти автомобили, претендующие на отнесение к классу раритетных. К таковым относят автомобили отечественного производства в возрасте не менее 30 лет, либо зарубежные автомобили в возрасте не менее 25 лет, либо автомобили, имеющие пробег не менее 500000 км без учета возраста. Указать государственный номерной знак, год выпуска и пробег каждого из них. <br> Ответ: 6 строк, 3 столбца. Автомобиль с государственным номерным знаком "c945op57" вызывает подозрение о некорректном указании пробега.

52.	 Найти автомобили, которые посещали предприятие только по пятницам. Выдать государственные номерные знаки. <br> Ответ: 9 автомобилей, один из которых – "c806yc57". 
53.	 Найти все автомобили, обслуженные механиком Баженовым М.К. (все виды ТО), и (в том числе включительно) отремонтированные механиком Савостьяновым А.В. (только ремонты). Указать их государственные номерные знаки. <br> Ответ: 1 автомобиль, государственный номерной знак "k857po77".

54.	 Найти механиков, которые в 2018 году ежемесячно (без пропусков) получали наряды на обслуживание или ремонт автомобилей. Выдать их фамилии и инициалы. <br> Ответ: Голубев Д.Н.

55.	 Найти автомобили, которые обслуживались только в 2018 году. Указать государственный номерной знак, дату проведения обслуживания и техническое заключение по его результатам. <br> Ответ: 9 строк, 3 столбца.

56.	 Выдать список рабочих дней в феврале 2018 года, в которые не выполнялись заказы по обслуживанию или ремонту автомобилей. Выдать даты дней без заказов. <br> Ответ: 16 дней, в том числе 14 февраля 2018 года.

## Агрегирование данных, групповые операции

57.	 Определить количество работ, выполненных в 2017 году. <br> Ответ: закрыто 98 заказов. 
58.	 Рассчитать общую сумму НДС, уплаченную в 2016 году (НДС рассчитывается как 18% от суммы платежа) за приобретенные автомобили. Результат округлить до копеек и представить в виде количества рублей и копеек. <br> Ответ: 7 487 998 руб. 20 коп.

59.	 Определить, сколько учтено автомобилей, зарегистрированных в Орловской области. <br> Ответ: 147 автомобилей.

60.	 Определить средний возраст механиков предприятия с точностью до двух значащих цифр мантиссы. <br> Ответ: по состоянию на ноябрь 2022 года –  42.23 года.

61.	 Определить общую и среднюю стоимость с точностью до копейки, общий и средний пробег с точностью до 100 м всех зарегистрированных автомобилей. Указать в качестве имен столбцов требуемые вычисления. <br> Ответ: 368 750 290.00,   2 290 374.47,  26 075 702.0,   161 960.8.

62.	 Определить средний пробег автомобилей каждого бренда. Результат округлить до 10 м. <br> Ответ: 10 строк, 2 столбца. Средний пробег автомобилей BMW 70937.40 км.

63.	 Рассчитать среднюю стоимость с точностью до копейки каждой марки зарегистрированных автомобилей. В выдачу включить наименование бренда, марки и среднюю стоимость. <br> Ответ: 47 строк, 3 столбца.

64.	 Определить с точностью до двух значащих цифр мантиссы средний возраст автомобилей каждой марки. Для автомобилей, у которых не предусмотрена марка, указывать модель. <br> Ответ: 49 строк, 2 столбца.

65.	 Определить год, за который поступило больше всего заказов (относительно других лет). <br> Ответ: 2019 год.

66.	 Построить распределение марок автомобилей, ограничив список марками, встречающимися не менее 8 раз. Список упорядочить по уменьшению количества экземпляров марки. <br> Ответ: "ГАЗ Газель" (24), "ВАЗ Веста" (16), "BMW Serie 3" (8).

67.	 Найти автомобили, владельцы которых за все время разместили заказ только один раз. Выдать государственные номерные знаки. <br> Ответ: 35 автомобилей, один из которых "y474kx57".

## Совместное использование конструкций языка SQL

68.	 Найти автомобили, выпущенные в Евросоюзе. Выдать государственные номерные знаки, государственную принадлежность и наименование завода-изготовителя, его фактический адрес и телефон. <br> Ответ: 44 автомобиля из ФРГ и Франции.

69.	 Найти автомобили, которые проходили на предприятии только предпродажную подготовку. Указать их государственные номерные знаки, дату предпродажной подготовки, фамилию и инициалы механика, проводившего работы. <br> Ответ: 86 автомобилей, один из которых "e346kx57".

70.	 Определить автомобильный бренд, на который клиенты предприятия, вместе потратили больше всех денег (найти «автомобиль богатых»). <br> Ответ: Mercedes-Benz.

71.	 Определить, сколько автобусов обслужено механиком Кротовым К.О. <br> Ответ: 4 автобуса.

72.	 Найти автомобили, которые были приобретены не новыми (интервал между датой выдачи свидетельства о регистрации транспортного средства и датой начала эксплуатации больше двух недель). Выдать государственные номерные знаки, производителя, марку, модель, серию, номер и дату выдачи свидетельства о регистрации транспортного средства, дату начала эксплуатации. Все данные, кроме даты начала эксплуатации организовать одним столбцом по формату: <Государственный номерной знак> <Производитель><Марка><Модель>, Свидетельство о регистрации <Серия СРТС> № <Номер СРТС> выдано: <Дата выдачи СРТС>. <br> Ответ: 72 автомобиля.

73.	 Сформировать список заводов по производству автомобилей, размещенных на территории Российской Федерации, и, в зависимости от того, входит ли страна бренда в Европейский союз или нет, указать наименование бренда, предприятия, почтовый или фактический адрес соответственно (для стран Евросоюза указывать почтовый адрес), телефон. <br> Ответ: 7 строк, 4 столбца.

74.	 Найти производителей, автомобили которых в 2018 году реже остальных требовали ремонта. Выдать названия брендов и количество ремонтов их автомобилей. <br> Ответ: "Peugeot" – 2 ремонта.

75.	 Найти механиков, которые выполнили больше работ, чем Голубев Д.Н. В выдачу включить фамилии и инициалы этих людей. <br> Ответ: восемь механиков, один из которых – Лосев П.Л.

76.	 Найти автомобили, зарегистрированные в один и тот же день. Выдать государственные номерные знаки, в одном столбце через пробел производителя, марку и модель каждого из них, дату регистрации. <br> Ответ: 24 строки, 3 столбца.

77.	 Для каждого автомобиля указать число посещения им предприятия (учитывать, что могут быть автомобили, которые ни разу не обслуживались, в этом случае выводить значение 0). Вывести государственные номерные знаки, серии, номера и даты их свидетельств о регистрации транспортного средства и количество посещений. Выдачу отсортировать по количеству посещений. <br> Ответ: 161 строка, 5 столбцов.

78.	 Найти автомобили, которые в 2016, 2017 и 2018 годах совершили 80% и более посещений предприятия от всего объема их обслуживания за все время. Вывести их государственные номерные знаки. <br> Ответ: 22 автомобиля, один из которых – "y777yy57".

79.	 Найти механиков, получивших сертификат на работу после достижения ими пенсионного возраста. Учесть, что до 2018 года возраст выхода на пенсию для мужчин составлял 60, а для женщин – 55 лет, а с 2018 года эти показатели увеличены на 5 лет и действуют относительно тех, кому настал срок выхода на пенсию. Прогрессивную шкалу роста пенсионного возраста не учитывать. Выдать фамилии, инициалы и даты рождения механиков, даты получения ими сертификатов и приема на работу. <br> Ответ: два человека (Савостьянова Н.М. и Бекетов А.С.).

80.	 Сформировать отчет о выполненных ремонтах автомобилей за все время работы предприятия. В отчете отобразить: государственный номерной знак; в одном столбце через запятую наименование производителя, марку и модель; также в одном столбце указать через пробел серию, номер и дату выдачи свидетельства о регистрации транспортного средства; дату проведения ремонта; фамилию и инициалы механика, выполнившего ремонт; техническое заключение по ремонту. Все даты приводить в формате "dd.mm.yyyy". <br> Ответ: 141 строка, 6 столбцов.

81.	 Определить долю в процентах (с точностью до двух значащих цифр мантиссы) в общем результате предприятия механика Савостьянова А.В. Считать, что все работы (заказы на ремонт или обслуживание) являются одинаково весомыми в общих итогах работы предприятия. <br> Ответ:  6,41%.

82.	 Сформировать список инвестиционно не выгодных автомобилей. К таковым относятся автомобили с пробегом не менее 100 000 км, или имеющие возраст 3 и более года, или побывавшие в ремонте хотя бы один раз, а также автомобили из транспортных групп "Специальные автомобили", "Специализированные автомобили", "Спортивные автомобили" или "Спортивные мотоциклы". В список включить столбцы: "Государственный номерной знак", "Возраст", "Пробег" и "Дата последнего ремонта". Если автомобиль в ремонте не был, то в последнем столбце должен храниться пробел. <br> Ответ: 131 строка, 4 столбца.

83.	 Определить проводилось ли не регламентное техническое обслуживание автомобилей японского производства. Не регламентным считается любое техническое обслуживание, не предусмотренное для автомобилей, выпущенных японскими производителями. В выдаче указать государственные номерные знаки, производителя, марку, модель автомобиля, вид, дату и заключение по проведенному не регламентному ТО, фамилию и инициалы механика, выполнявшего работы. <br> Ответ: 10 строк, 8 столбцов, два автомобиля с государственными номерными знаками "a450ox57" и "k161op57".

## Задания повышенной сложности

84.	 Определить самый не надежный автомобиль, который имеет наименьший интервал между двумя любыми ремонтами. Указать его государственный номерной знак и наименьший интервал между ремонтами в секундах. <br> Ответ: автомобиль с государственным номерным знаком "a964oa57". Интервал составляет 18720 сек.

85.	 Найти объем убыли клиентов с ростом возраста автомобилей, составив таблицу, где в одном столбце указан номер ТО, а в другом – число выполненных работ соответствующего вида. Данные должны быть отсортированы по номеру и виду ТО, сначала ТО-1. После перечисления всех видов ТО приводятся сведения по ТО для японских автомобилей. <br> Ответ: 16 строк, 2 столбца.

86.	 Составить таблицу изменения рентабельности предприятия по годам, где показаны абсолютное число выполненных заказов, относительное число заказов на один зарегистрированный автомобиль (учесть, что после выполнения предпродажной подготовки, автомобиль более не является зарегистрированным, хотя данные о нем сохраняются в базе данных), абсолютный прирост числа заказов, упущенная выгода в виде не добранных процентов если считать за 100% ситуацию, когда все зарегистрированные автомобили прибывают на предприятие один раз в год. <br> Ответ: 25 строк, 4 столбца.

87.	 Составить "возрастную карту" зарегистрированных автомобилей, включив в нее столбец наименований изготовителей, столбцы для указания доли в процентах, округленной до двух значащих цифр мантиссы, автомобилей в возрасте от 0 до 6 лет, от 7 до 10 лет, от 11 до 13 лет, от 14 до 18 лет и старше 18 лет. <br> Ответ: 10 строк, 6 столбцов. 
88.	 Определить завод-изготовитель, продукция которого больше других требует ремонта
(гарантийный срок не учитывать) в абсолютных показателях и завод с наибольшей долей
отказов продукции (число ремонтов на один зарегистрированный в базе данных автомобиль). Выдать наименования, принадлежность брендам, страны брендов, почтовые адреса и 
телефоны (в двух столбцах), количество ремонтов выпущенных ими автомобилей и долю 
ремонтов на один зарегистрированный автомобиль. <br> Ответ: по обоим показателям один и тот же завод "Austria Bavarischen motorwerke" с абсолютным показателем 3 отказа и долей в 0.666667.

89.	 Найти автомобили с заводским браком (интервал времени между датой регистрации и первым ремонтом, не превышающий 1 года). Выдать их государственные номерные знаки; производителя, марку и модель в одном столбце; дату регистрации; дату первого ремонта; интервал в днях от регистрации до первого ремонта. <br> Ответ: 3 автомобиля, два NISSAN и один ГАЗ.

90.	 Найти автомобили, которые в течение одного года обслуживались или ремонтировались только у разных механиков. Выдать их государственные номерные знаки, даты, когда проводилось обслуживание или ремонт, фамилии и инициалы механиков. Учесть, что автомобили, посещавшие предприятие один раз в году, также относятся к обслуженным разными механиками в этом году, отсортировать выдачу по государственным номерным знакам. <br> Ответ: 344 строк, 3 столбца.

91.	 Определить медианное значение и разброс стоимости зарегистрированных автомобилей, считая, что стоимость распределена нормально. Для определения медианного значения стоимости использовать математическое ожидание, рассчитанное, как сумма произведений каждой стоимости на количество ее повторов в ряду стоимостей, деленное на общее число зарегистрированных автомобилей. Разброс рассчитать, как квадратный корень из разности медианы ранжированного ряда квадратов стоимости и квадрата медианы. <br> Ответ: медиана – 2 290 301 руб., разброс – 3 932 362 руб.

